apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "gdpr-anonymizer.fullname" . }}
  labels:
    {{- include "gdpr-anonymizer.labels" . | nindent 4 }}
data:
  config.yaml: |
    # LLM Provider Configuration
    llm:
      provider: {{ .Values.config.llmProvider | quote }}
{{- if eq .Values.config.llmProvider "claude" }}
      model: {{ .Values.config.claude.model | quote }}
      max_tokens: {{ .Values.config.claude.maxTokens }}
      temperature: {{ .Values.config.claude.temperature }}
      api_key_env: "ANTHROPIC_API_KEY"
{{- else if eq .Values.config.llmProvider "openai" }}
      model: {{ .Values.config.openai.model | quote }}
      max_tokens: {{ .Values.config.openai.maxTokens }}
      temperature: {{ .Values.config.openai.temperature }}
      api_key_env: "OPENAI_API_KEY"
{{- else if eq .Values.config.llmProvider "ollama" }}
      model: {{ .Values.config.ollama.model | quote }}
      max_tokens: 4096
      temperature: 0.1
      ollama:
        base_url: {{ .Values.config.ollama.baseUrl | quote }}
{{- if .Values.config.ollama.authToken }}
        auth_token: {{ .Values.config.ollama.authToken | quote }}
{{- end }}
{{- end }}

    # Agent Configuration
    agents:
      agent1:
        name: "ANON-EXEC"
        enabled: true
        prompt_version: "v1"
      agent2:
        name: "DIRECT-CHECK"
        enabled: true
        prompt_version: "v1"
      agent3:
        name: "RISK-ASSESS"
        enabled: true
        prompt_version: "v1"

    # Orchestration Settings
    orchestration:
      max_iterations: {{ .Values.config.anonymization.maxIterations }}
      timeout_seconds: 300
